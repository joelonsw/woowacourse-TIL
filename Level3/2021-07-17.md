### 2021-07-17

## Powershell에서 AWS 인스턴스 접근 자동화
- **동기**
    - 매번 pem키 있는 폴더 들어가고, ssh -i ~~~ 명령어 치는게 번잡스러움
    - 많은 인스턴스들을 사용하면서, 접속하는 ip들이 다양해짐
        - 기도메타로 WAS겠지, DB겠지 하는 것에 대한 피로도 증가
- **해결 방법**
    - *참고 1: https://superuser.com/questions/1183386/setting-up-an-alias-for-ssh-command-in-windows-powershell*
    - *참고 2: https://www.howtogeek.com/50236/customizing-your-powershell-profile/*
    1. Alias로 ssh 명령을 쟁여두자
        - 안타깝게도 다음과 같은 에러메시지 출력
            - `Set-Alias : 매개 변수 이름 'i'이(가) 모호하므로 매개 변수를 처리할 수 없습니다. 일치하는 항목은 다음과 같습니다.  -InformationAction -InformationVariable.`
        - 전체 문자열 자체를 커맨드로 실행시키려고 해서 그럼
            - ssh -i "pemkey" user@ip <- 여기서 ssh만 커맨드임
            - "-i" 이런건 파라미터라서 별명 지정이 불가
    2. function을 통해 ssh 연결 과정을 정의하기
        - function nolto-was {ssh -i "pemkey" user@ip} 와 같이 함수로 지정
        - 성공적으로 실행됨!
        - 하지만 파워쉘 끄면 날라감
    3. powershell script (ps1) 파일에 function 정의해두고, 파워쉘 키면 자동 실행되게 하기
        - `New-Item -path $profile -type file -force`로 ps1 생성
        - 다음과 같이 작성하기
        ```shell script
        set-location c:
        function nolto-ws {ssh -i "C:\Directory\PEMKEY\real.pem" ubuntu@1.2.3.4}
        function nolto-was {ssh -i "C:\Directory\PEMKEY\real.pem" ubuntu@1.2.3.4}
        function nolto-db {ssh -i "C:\Directory\PEMKEY\real.pem" ubuntu@1.2.3.4} 
        function joel-test {ssh -i "C:\Directory\PEMKEY\real.pem" ubuntu@1.2.3.4}
        function joel-web-hosting {ssh -i "C:\Directory\PEMKEY\real.pem" ubuntu@1.2.3.4}
        ```

## 도커 - 이미지 만들고 배포하기
- *참고: https://subicura.com/2017/02/10/docker-guide-for-beginners-create-image-and-deploy.html*
