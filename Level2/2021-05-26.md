### 2021-05-26

## 브라운 Spring config 수업 복습
- **배경 지식 강의**
    - [컨테이너 설정 방법]
        - XML
            ```xml
            <?xml version="1.0" encoding="UTF-8"?>
            <beans xmlns="http://www.springframework.org/schema/beans"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd">
            
                <bean id="userRepository" class="nextstep.helloworld.core.xmlConfig.UserRepository"/>
            
                <bean id="userService" class="nextstep.helloworld.core.xmlConfig.UserService">
                    <property name="userRepository" ref="userRepository"/>
                </bean>
            </beans>
            ```
        - Annotation-based configuration
            - `@AutoWired`
        - Java-based Configuration
            ```java
            @Configuration
            public class AppConfig {
                @Bean
                public MyService myService() {
                    return new MyService();
                }
            }
            ```

- **Java-based Configuration**
    ```java
    @Configuration
    public class AuthenticationPrincipalConfig {
    
        @Bean
        public AuthService authService() {
            return new AuthService();
        }
    
        @Bean
        public AuthenticationPrincipalArgumentResolver authenticationPrincipalArgumentResolver() {
            return new AuthenticationPrincipalArgumentResolver(authService());
        }
    }
    ```
    - 생성하는 authService()와 주입 받는 authService()는 동일하다!
    - 빈 등록시 의존이 필요하면 먼저 생성하고 의존한다
        - Singleton으로 하나씩만 생성하자!

- **외부 파일의 값을 이용하기**
    - `@Properties`
        - *참고: https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-using-propertysource*
        - Spring Environment에 PropertySource를 손쉽게 추가하도록 함
            - key-value의 쌍들로 이루어진 .properties 파일들을 추가해준다면, env.getProperty("key"); 를 통해 가져오기 가능
            
    - `@Value`
        - *참고: https://docs.spring.io/spring-framework/docs/current/reference/html/core.html#beans-value-annotations*
        - *참고: https://www.baeldung.com/spring-value-annotation*
        - Properties를 읽는 방법 중 하나
        - 외부 property들의 값을 주입할 때 사용
        - Spring이 관리하는 bean들에 값들을 주입할 수 있는 어노테이션
            - Configuration 클래스에서 `@PropertySource` 설정을 해두자 
            - `@Value("${systemValue}")` 를 통해 주입가능
    - 환경에 따라 Bean/Property 값을 다르게 할 수 있음
        - `@Profile`
            - *참고: http://wonwoo.ml/index.php/post/1933*
            - 각 환경 *(profile)* 에 맞게 Spring의 Bean들을 올릴 수 있음
                - dev / test / prod
            
- **Configuration의 역사**
    - XML -> Java-based config 
    - Spring Boot & Auto Configuration
        - Spring Boot
            - 바로 실행할 수 있는 어플리케이션을 쉽게 만들 수 있게 도와줌
        - Auto-config
            - 별다른 설정을 안해주었음에도 DB, JdbcTemplate 등등 다 잘씀
            - `@EnableAutoConfiguration`
            - jar dependency 기반으로 스프링 어플리케이션 자동 설정
                - 'org.springframework.boot.starter~~~'
                - 엄청 많은 auto configuration이 자동으로 로딩됨
            - 예시) JdbcTemplateAutoConfiguration
                - Dao에서 JdbcTemplate 안만들고 알아서 주입되서 잘 사용됨
                - spring.factories 내의 org.springframework.boot.autoconfigure.jdbc.JdbcTemplateAutoConfiguration 에서 설정을 해둠
        - `@Condition, @Conditional`
            - 조건에 따라 설정할 수 있도록 auto-config 
        
- **과제**
    - Auto Configuration 디버깅 해보자!
    - Spring Boot Application 디버깅 해보자!
        