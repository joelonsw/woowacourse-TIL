### 2021-05-07

## DTO Validation, DTO 변환
- *참고: https://github.com/HomoEfficio/dev-tips/blob/master/DTO%EC%99%80%20Bean%20Validation.md*
- *참고: https://github.com/HomoEfficio/dev-tips/blob/master/DTO-DomainObject-Converter.md*
- __DTO Validation__
    - 클라이언트의 정보는 DTO로 담겨 서버로 넘어오게 됨
    - DTO에 반드시 넘겨자야 할 필수 정보 누락되면 오류가 발생...
        - 클라이언트 잘못인지, 서버 잘못인지 판단해야함
        - 논리적으로 보면 필요한 정보를 똑바로 안넘겨준 클라이언트 잘못
        - 4xx 에러를 뱉어줘야 함
            - @NotNull을 사용하여 필요한 정보 안들어왔다면 에러를 처리하도록 하자
            - @Valid를 사용하여 넘어온 DTO 검증하도록 하자
            ```java
            import javax.validation.constraints.NotNull;
            public class ProductDto {
            
                @NotNull
                private String productCode;
                
                ...
            }
            
            @Controller
            public class ProductController {
                @RequestMapping(value = "/whatever", method = RequestMethod.POST)
                public void saveProduct(@Valid ProductDto productDto, BindingResult bindingResult) throws BindException {
                    if (bindingResult.hasErrors()) {
                        throw new BindException(bindingResult);
                    }
                }
            }
            ```
- __DTO-Domain 변환 위치__
    - 프론트엔드의 View에는 DTO가 전달되고, 백엔드의 데이터 저장소에는 결국 Domain 객체가 필요
        - 중간 어디선가 변환해주는 지점이 필요!
    - 서비스에서 변환해주는 것이 타당하다 
        - Domain -> DTO는... DTO에 들어갈 정보를 Domain이 충분히 알고 있어서 변환 쉬움
        - DTO -> Domain은... 가령 id 값 만으로 Domain 생성 불가! Repository 조회 하던가 해야함! 
            - 따라서 변환 로직은 서비스에서 책임을 갖는 것이 좋음
            - 컨트롤러에서 도메인 객체 구성할 능력이 없음
